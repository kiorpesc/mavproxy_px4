<!DOCTYPE html>
<html>
    <head>
        <title>WebSockets Demonstrator For LFY</title>
    </head>
    <body style="font-family: Lekton; font-size: 24pt">
        <p style="width: 800px">HEARTBEAT:</p>
        <div id="heartbeat_div" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="HEARTBEAT">TEXT HERE</p>
        </div>
        <div id="sys_status_div" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="SYS_STATUS">TEXT HERE</p>
        </div>
        <div id="vfr_hud_div" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="VFR_HUD">TEXT HERE</p>
        </div>
        <div id="atti_div" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="ATTITUDE">TEXT HERE</p>
        </div>
        <div id="gps_int" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="GLOBAL_POSITION_INT">TEXT HERE</p>
        </div>
        <div id="gps_raw_div" style="font-size: 12pt; height: 100px; width: 800px; border: 1px solid black">
            <p id="GPS_RAW_INT">TEXT HERE</p>
        </div>
        <div id="chatbox" style="font-size: 14pt; height: 500px; width: 800px; overflow: scroll; border: 1px solid black"></div>
        <form id="conversation" onsubmit="DispatchText()" action="javascript:void(0);">
            <input type="text" id="message" name="message" autocomplete="off" style="width:700px" />
            <input type="submit" id="sub" name="sub" value="Send" style="width:90px" />
        </form>
        <script type="text/javascript">
            var ws = new WebSocket("ws://localhost:8888/websocket");
            ws.onmessage = function(evt){
                var msg = evt.data;
                HandleMavlink(msg);
                //var msg_json = JSON.parse(msg);
                //x = document.createElement("p");
                //x.innerHTML = new_text;
                //document.getElementById("chatbox").appendChild(x);
                //out_str = new_text.mavpackettype + String(new_text.system_status);
                //document.getElementById("heartbeat_text").innerHTML = msg_json;
            }
 
            function DispatchText(){
                //first, get message from input field
                var userInput = document.getElementById("message").value;
                //then, clear input field
                document.getElementById("message").value = "";
                //now, create a paragraph element
                x = document.createElement("p");
                //set the p text to the input 
                x.innerHTML = "You sent: " + userInput;
                //stick the input into the chat box
                document.getElementById("chatbox").appendChild(x);
                //send user input to server for processing
                ws.send(userInput);
            }

            function HandleMavlink(msg){
                var msg_json = JSON.parse(msg);
                document.getElementById(msg_json.mavpackettype).innerHTML = msg;
            }
        </script>
    </body>
</html>
